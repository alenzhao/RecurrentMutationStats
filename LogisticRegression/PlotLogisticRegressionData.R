
library(ggplot2)

load("~/Documents/Lab/SnyderLab/LocalMutationRate/LogisticRegression/newLRFit")
pids<-c("01eef340-598c-4205-a990-cec190ac2ca5","028e99e9-5b9a-4954-bb6e-6d4709a3cea8","037c57d1-b4a5-45dc-bda4-0550461d321b","045c13ef-3db7-4adf-b0a3-23338f0479f3","05fbd98c-28bd-41bc-ae60-16ac0c16c723","084c6aec-94f7-4090-8f3f-59fa9e89721a","08da7c4c-3067-4bcf-9d7a-78566df72e69","09066fbf-6a1d-46c9-a4c5-c53340c3d1ba","0956bc67-dd55-4c54-a56a-f22f2856662a","0ab8d063-62b4-4d47-82aa-e3351a60029d","0d66bf6c-eed0-4726-bd5b-3bf6d610b4e0","0df573ee-28f0-4244-b434-09e6ca59fbf0","0e2ee54a-51c9-4868-842d-a2a1c1cfb016","1174f6e4-ffbe-4e59-a000-8d861c968369","11ab53c8-6366-4bc9-b60d-23e6ed2d1cae","1200c8b7-a058-4c01-bbe2-04ec09a65245","13f31bcb-befd-4ed2-adc0-dc9e9ce52b75","1557183c-aedd-4df6-b98a-3654667f7b69","15c84da3-16e5-4909-aea9-cb5894b0f8af","16e69011-c295-479f-b521-86e66fba498d","180036a2-3b56-405e-a1fe-d5932517b6c7","18eb4dfc-556f-4bf3-a411-4780209ed1e0","199386c2-bb53-4fad-a1b6-59ab216a4a50","1ab7ad70-0f80-41d8-8efa-3baebc8223cc","1e417b93-837d-4110-9090-239eb82c3e20","1f11de87-a5fe-49fd-80c1-e279b2bc69de","1f744ada-6de1-446d-b62c-76a7fc8b40af","206ce0ed-36a4-47ab-ac8e-f6fca6ac5c18","20e8106b-1290-4735-abe4-7621e08e3dc8","21fb46f9-4bbb-441c-af19-a687e9138344","220be009-8f1e-4a77-ab04-3220b5f87ea6","233b02f3-c4f0-4a67-9db5-e68d5cdaccb6","267ff78b-bceb-466e-8582-c560fe227ff0","2779fa01-ac93-4e80-a997-3385f72172c3","277b02e9-ded5-4980-845d-af53690000ac","27b05b15-a44b-45ed-a6e3-e7d1ca488ea9","28e9b6f9-ab6a-400b-a6a9-79095a443591","2b865f8c-539f-4cb2-8f08-41709e9511e5","2c5fa2d4-8e35-42e4-8bca-9fb3371a19c8","2c86c3ea-d926-4d39-a5ae-39ece4774287","2ed3296a-5b10-40d8-8af4-90dc031657cd","2f4a127f-101a-4192-b3e8-f9be2c8648bc","3199cfe5-3be3-43cd-a36b-5cf2c7a9929f","31c96e35-5e2f-429c-b12a-7bc5a497a300","324bcba2-f6a4-45a6-807c-215bdffcca21",
        "3258cb3b-f63b-463c-b2e4-d638149157c5","328dfcb0-b5ae-43f2-bc87-dad0ab3df9e7","352768f9-3ce1-419c-beef-6515c78f5d7a","35cb7841-9b09-465a-90c5-e3b8a9faad49","386b629e-fab1-4033-b088-45d6eeb4a13e","38a8b734-9acc-42f9-b5b7-e51b0dfc6504","3a4a6aff-4720-41fc-a114-85f38610ebb1","3c975b68-4a6e-4c97-a8d1-b9a427d4957c","3cbca837-f5a7-4a87-8f02-c59eac232d5a","3e976301-4042-4ac0-8f01-ef2f1a8161a6","3edf933a-be1a-46e8-bfb0-acdff30e64a0","3f93d1cf-a307-4e29-9e6f-239e9ffaa179","3f960d3b-a58c-43d0-a8a4-f3555b399c9d","4075717b-2240-4842-a00a-0c4dbcb910c4","43abe847-4ba7-466e-8283-5d7b80b999a7","441919eb-8c9f-478c-bda3-8de4f8295e8a","446ce2a3-d328-443c-a419-3344baad0e16","44dec838-b653-42a7-a58b-a1fd232cd68c","46592b7b-6968-42a6-83af-0917c9f4a9a5","468649e7-1525-4b8a-8ab5-ddb27db5f022","4b2ec8aa-8460-440e-b75b-6b92ae7a3ffc","4bf50455-9ab7-4521-a791-089f66d3b877","4bfbce2b-9d0b-4e8a-950f-fd8e0ba3e05a","4c31127e-d095-4978-9dac-35153c27f6ed","4c325ee1-9b8e-45d4-a0a7-e47ec1eac402","4cffea0b-90a7-4c86-a73f-bb8feca3ada7","4edff57f-4b0e-4770-beac-590da7d7232c","4fca10bd-988a-47f9-8ed5-037c0d59d70c","521ea765-1bd1-423d-a75d-091243df37a9","534f85f2-b9eb-45be-87d5-c3dffd13d541","54254f5a-50e8-4150-a9b7-56a0470d2a56","5580b21a-2cdb-4777-ad79-6e06654144f5","566792ae-f853-4a47-856d-f02cdcfcb18a","585e6487-b0a3-4828-8a06-46bee01dff74","5a57dc25-d252-4b22-b192-4de630d7002f","61c655ec-52b5-453f-a6cc-b2aba445b027","63bd2175-4b7c-44c9-aef3-9efc8f79837b","659668e8-f0d9-4ff2-bbc8-9246f2ef49ab","673493f6-975c-49e8-934c-001e9a0fff90","6956473b-92e5-4069-a26b-b48e280e76f2","6c5154d2-af36-492f-b520-d925528824e4","6d72de06-232a-4983-a06c-eba6d82cb3f1","6dfd47d2-831a-4386-9051-f78199a16bb5",
        "6fd72426-f6c8-47ca-a500-d5d3600b9b15","713190ed-c6c1-4695-814b-85ca9b95e6a0","71fed998-8fac-4e6b-b38a-22c83e05e958","733a2a0f-b37a-4b81-b49e-3c0f30d1eb37","737b35e1-d668-4fce-9b6e-76946c7952b6","762dea8a-5b41-4058-979a-b7876ed13d7e","781acafa-a58b-4180-bbca-c5b675d51b17","784de7ac-8424-42eb-83d4-a1bebaa42b97","7861a5f2-8910-4bcb-9c34-f79c5acd6e21","786e8dbe-442e-4551-87b3-b4c333b04dd4","7b0622ab-63ea-483f-ae40-d3ea587bdbba","7b7d2d2b-abe6-4f32-add0-3715096995d1","7b9947d5-e86b-4006-8890-ea5209584a88","7d3e77cc-9603-4722-8e39-1912b678871b","7dce4215-01f6-43e9-9378-9e22c26c23a2","7de19081-d5fd-468c-ad0d-f6e3e8b2ad70","80c4fc5b-dc7d-4308-8c81-6e83625963b5","832316ee-08ab-412b-9e4d-8a57ff84bc11","8994c8c4-9ea0-46cb-b4a5-0055d7da5bfa","89f91e36-fed8-4da3-8a35-c761d6f65285","8aaa4e25-5c12-4ace-96dc-91aaa0c4457c","8bd68696-5eeb-46d7-9dc6-c39c849029a4","8cf54607-01ce-42b0-9bd9-8627edd9f3b7","900b5f21-e8fb-4a3f-b8e3-ef098716e508","90a8d2cb-1f31-45f9-8575-eed3cb9a7798","914d8613-3c25-4a10-be50-28b42f4d3a5d","9293e197-e38a-4e19-a7d0-1b45d1ad48bd","96415324-6859-41eb-8d07-be4e6f7d9781","993103b1-e5a1-4c33-8629-be53ebc41d64","9938ce5c-e74e-446e-a932-f096f85cc3b1","99e32c59-aa73-43fa-88c9-399ddadb2c72","9aa8c2b4-db32-4899-bf0c-d578cb175e90","9ae5101b-6031-4ab1-bfca-198c41af3184","9b84d013-713b-4571-888c-12863fdd4a52","9d95a65b-e41d-4f93-92d4-99dce29ff40d","9da334ed-314c-4445-ba29-ffd9bb42403c","9dc7812b-c7a2-4de4-bf6d-4c7261384a62","9e178d80-fe90-4998-9dae-726c4beceef7","9f5c0a43-d222-484a-9249-d288387dd7a1","9f632fc3-2241-469a-a14a-cd537350155f","9f81c602-8afa-4588-b0b6-6e5a1a128d5a","9f89510c-ed07-471f-b35e-7c87c237b9fe","a02932f3-5606-42a5-aee4-e5b9f5aa1aaa","a081da6f-51f3-4555-a6b8-736f8c6cda39","a1e65587-24c1-4b41-92a7-4e1f15fffd78",
        "a3de401d-91fe-49a2-bb07-81c1a06506e6","a3e1ac67-a1f2-44fb-8343-a7e8239fc24a","a515cf2d-e918-4958-9bf6-e611b425a97e","a587e62e-430e-4f1b-82b7-6fbe856fdaf1","a8015490-9740-45c9-8bd2-eb6d1beefc2e","a824b3bd-34d5-4cc1-a92f-f9d6ac0f1814","a8614c49-c7f1-4de9-bd2f-4764b094d604","a8d6694c-a213-4544-ac0b-63bce16d8f4e","a9b7d7fe-be31-4f71-afee-c1bfdf511888","a9d3a7b0-faf8-4e56-8600-d9e6882a4f23","acae4e48-57de-40c5-9ae5-4386144ebaea","af37d8f0-fea0-47f6-be0a-2fb55a5da5c4","b1c4579c-72fa-4974-830c-b6a81ace45f4","b3631718-9e0a-454c-bee1-8f36ebc509d8","b37d944c-c65c-46d6-bb8b-3eb37cb85b68","b43e41af-1d82-4b5f-b8f1-add0510e6b86","b58ad350-5140-4fa8-bc2c-24bca8395f3a","b5fba77b-1f50-4e71-95b2-566afba4bdd7","b60f22ac-a659-4f33-b01d-820e86a9a5c9","b913d254-8307-4b8a-8313-d978e32bb38f","ba9d4568-71a8-41fc-a2be-0bf784e36d6a","bbdaa931-e922-49be-bfbf-fa0c2ae27d7a","bd4284a7-260d-48b3-9b48-a1c578c30d27","bf15f7ad-9d92-473b-91d1-f24aa373ab97","bf6b931e-cb2e-4cc0-b603-e9fc71fdc509","bff84539-7862-45b2-b5fc-e77291fcca8b","c0892598-1f7b-4f23-9cd8-731f797753d5","c184c3ca-7ad3-4202-b108-cb9fd5f5d947","c1f50a22-38df-41cc-a1f4-f7985504a7ac","c350b53b-3c27-4b9e-8b57-d7b6a1205a1f","c364e81c-eb1e-4870-ab37-9c661f5f2e3d","c931f3bd-74c5-4ebd-bc0f-c7c6becd25ab","cc353686-e2b6-46a1-8095-48e2bc44b11f","cc4bd56a-25c5-4c48-b583-ac3aeb778ca6","ccd4a24b-d8cc-4686-9dee-c98b0c5a8d21","cd032ddb-55f2-4c77-8dcf-e4e630f7de6f","cd0dc947-b708-464e-beb7-954c9d4583e7","ce8612ab-3149-4a6a-b424-29c0c21c9b8b","cfc999aa-802e-4a0d-8b14-be2b19fa2a17","d17668c4-5d66-4e16-8b70-b54616581aae","d189a6c6-210f-4957-b500-457d5ce3f867","d1eeaca3-52c0-4a0c-916a-fd64cec911d9","d2824e6d-3784-45c2-9b0f-52b17356b5da","d2aa7d70-a25f-4a9e-9d52-37e372461824","d2ca9a4d-c14c-40c0-871c-88794a02e4aa",
        "d2f2560c-ec80-4fea-9474-c47a2e85ea95","d5326429-9805-47f9-97b0-fbda658e3f01","d5eedfb5-4fa3-4a1e-ad0d-ea550b22a5ba","d67cd793-2931-429a-9084-2f3c4c8be7ad","d7641ca1-a062-4dd2-9414-447af7311a84","d8d7a6c2-6427-4f47-968c-6c3affba4617","da61857a-b00e-4a19-ab02-8fbb2ee56bea","db058eb4-9c5e-4226-92d1-de24aea83630","dbd5b0de-94c9-45dd-afb3-6820a7ecaca2","dcff8659-ecca-4798-80a3-dd6e7642ba2b","dee43082-4aa7-4650-981c-a779e9fe7b55","e16ca88f-488b-40f0-9169-e5a62482a2ff","e1e8dc66-467c-48a5-be56-3db4f665b9f1","e4fc0909-f284-4471-866d-d8967b6adcbc","e58e8850-154f-4695-bee0-005c76410327","e737f650-b72d-44e7-b750-558a56716803","e9f4f373-37a5-48ad-a1a0-b0d47820111a","eb2dbb4f-66b6-4525-8323-431970f7a64e","ec7a9d74-8b3f-4747-8926-1739a016ab2b","ee0a4a13-613e-4c5d-96c3-8083a013702d","ef6f6553-2575-457e-bc07-401215e54759","f1985735-a188-4567-a88a-530f9b80291b","f2801b21-5444-4cc3-a642-c60c6d82cd3d","f34aa3b6-e966-49c6-bc55-130545772c53","f45f4a30-6b4c-4f15-9140-959d6a25a45f","f5759059-c0e3-4f1a-af96-5c7197d3c33c","f5bc5d97-e054-4e53-992d-71b896bd97d5","f6e1ec78-5ad9-4879-9b7e-262d17b166ad","f77b6930-a1ce-446e-a15d-c018cbbecfee","f77cf4d3-9829-4fd3-95a1-b29aed9e94b8","f8ac5fd2-11f2-4b3a-a3a6-ff1a6d8e1cae","fb79c491-7b01-42ae-8369-8364e442e31b","fba80122-d8b2-4d8d-a032-9767e8160f9f","fcecafa8-8b8b-4ae6-81bc-73acf05b211a","fd9ee494-65fe-4de4-adff-7952a059b17f","ff530f28-0ec0-4494-bb54-44bb055bae1c","ff9def3d-17e5-4ef6-b74e-933f11ed6f00","ffaa98a0-2b69-46dc-aee5-c5c3f2abbc38",
        "0a2a3529-f645-4967-9a58-89ee20b8bb62","5338d435-68fb-4f0d-a3e6-c843f703f75f",
        "9435447e-d65f-408b-863b-6576b1d652dd","be3a7ef3-34ed-40e1-9d9c-187940596b26",
        "b3631718-9e0a-454c-bee1-8f36ebc509d8","c1f50a22-38df-41cc-a1f4-f7985504a7ac",
        "180036a2-3b56-405e-a1fe-d5932517b6c7","cd032ddb-55f2-4c77-8dcf-e4e630f7de6f",
        "ba9d4568-71a8-41fc-a2be-0bf784e36d6a","90a8d2cb-1f31-45f9-8575-eed3cb9a7798",
        "9f89510c-ed07-471f-b35e-7c87c237b9fe","96415324-6859-41eb-8d07-be4e6f7d9781",
        "0956bc67-dd55-4c54-a56a-f22f2856662a")
# get test data
testDataAll<-do.call(rbind, lapply(pids, function(pid) data.frame(refPair=c(rep("AT", 500), rep("CG", 500)),
                     replicationTiming=rep(1:100, 10),
                     transcriptType=rep(c(rep("none", 100), rep("coding_exon", 100), rep("coding_intron", 100), rep("noncoding_exon", 100), rep("noncoding_intron", 100)), 2),
                     pid=rep(pid, 1000))))
testDataAll$noTranIntProb<-predict.glm(object=newLRFit, newdata=testDataAll, type="response")
testDataAll$real<-F

t3<-testDataAll[, c("refPair", "replicationTiming","transcriptType", "pid", "noTranIntProb", "real")]
colnames(t3)<-c("refPair", "replicationTiming","transcriptType", "pid", "prob", "real")
t3$model<-"with replication timing and base pair interactions"
t<-t3
# ggplot(t[t$pid=="01eef340-598c-4205-a990-cec190ac2ca5",], aes(x=replicationTiming, y=log(prob), color=transcriptType, shape=real))+geom_point()+facet_grid(~refPair)+theme_bw()
# ggplot(t[t$pid=="028e99e9-5b9a-4954-bb6e-6d4709a3cea8",], aes(x=replicationTiming, y=log(prob), color=transcriptType, shape=real))+geom_point()+facet_grid(~refPair)+theme_bw()
t$replicationTiming<-factor(t$replicationTiming, levels=unique(t$replicationTiming))
ggplot(t, aes(y=log10(prob), x=replicationTiming))+geom_boxplot(outlier.size = 0)+facet_grid(transcriptType~refPair)+theme_bw()


# plot data
# toplotAll<-rbind(allMerged[, c("refPair", "replicationTiming","transcriptType","pid", "prob", "real")], testDataAll[, c("refPair", "replicationTiming","transcriptType", "pid", "prob", "real")])
# ggplot(toplotAll[toplotAll$pid=="01eef340-598c-4205-a990-cec190ac2ca5",], aes(x=replicationTiming, y=log(prob), color=transcriptType, shape=real))+geom_point()+facet_grid(pid~refPair)+theme_bw()#ylim(c(0, 0.0000075))
# ggplot(toplotAll[toplotAll$pid=="028e99e9-5b9a-4954-bb6e-6d4709a3cea8",], aes(x=replicationTiming, y=log(prob), color=transcriptType, shape=real))+geom_point()+facet_grid(pid~refPair)+theme_bw()#ylim(c(0, 0.0000075))
# ggplot(toplotAll[toplotAll$pid=="037c57d1-b4a5-45dc-bda4-0550461d321b",], aes(x=replicationTiming, y=log(prob), color=transcriptType, shape=real))+geom_point()+facet_grid(pid~refPair)+theme_bw()#ylim(c(0, 0.0000075))
# 
# ggplot(toplotAll[toplotAll$transcriptType=="none",], aes(x=replicationTiming, y=log(prob), color=transcriptType, shape=real))+geom_point()+facet_grid(pid~refPair)+theme_bw()#ylim(c(0, 0.0000075))
# ggplot(toplotAll, aes(x=replicationTiming, y=log(prob), color=transcriptType, shape=real))+geom_point()+facet_grid(pid~refPair)+theme_bw()#ylim(c(0, 0.0000075))
# ggplot(toplotAll, aes(x=replicationTiming, y=prob, color=transcriptType, shape=real))+geom_point()+facet_grid(pid~refPair)+theme_bw()+ylim(c(0, 0.0001))



